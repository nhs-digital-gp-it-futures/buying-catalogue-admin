{% extends 'includes/layout.njk' %}
{% from 'components/back-link/macro.njk' import backLink %}
{% from 'components/button/macro.njk' import button %}
{% from 'components/bc-table/macro.njk' import bcTable %}
{% from './components/checked-statement.njk' import checkedStatement %}


{% block body %}
  <div class="nhsuk-width-container" data-test-id="organisation-page">
    <div data-test-id="go-back-link">
      {{ backLink({
        "href": backLinkHref,
        "text": "Back"
      }) }}
    </div>
  
    <h1 data-test-id="org-page-title" class="nhsuk-u-margin-top-7 nhsuk-u-margin-bottom-3">{{ organisationName }}</h1>
    <h2 data-test-id="org-page-description" class="nhsuk-u-font-size-22 nhsuk-u-margin-bottom-9">{{ description }}</h2>

    <h3 data-test-id="organisation-details-subheading" class="nhsuk-u-font-weight-bold nhsuk-u-margin-bottom-7">{{ orgSubheading }}</h3>

    <div data-test-id="edit-org-button">
      {{ button({
        text: editOrgButtonText,
        classes: "nhsuk-u-margin-bottom-9",
        href: editOrgButtonHref
      }) }}
    </div>

    <div class="nhsuk-u-font-size-19 nhsuk-grid-row nhsuk-u-padding-bottom-5">
      <div class="nhsuk-grid-column-one-half">
        <div class="nhsuk-grid-row">
          <div class="nhsuk-grid-column-one-half">
            <h4 data-test-id="org-page-ods-code-heading" class="nhsuk-heading-s nhsuk-u-margin-bottom-0">{{ odsCodeHeading }}</h4>
            <div data-test-id="org-page-ods-code" class="nhsuk-u-padding-bottom-6">{{ odsCode }}</div>
            <h4 data-test-id="org-page-primary-role-id-heading" class="nhsuk-heading-s nhsuk-u-margin-bottom-0">{{ primaryRoleIdHeading }}</h4>
            <div data-test-id="org-page-primary-role-id">{{ primaryRoleId }}</div>
          </div>
          <div class="nhsuk-grid-column-one-half">
            <h4 data-test-id="org-page-address-heading" class="nhsuk-heading-s nhsuk-u-padding-margin-0">{{ addressHeading }}</h4>
            {% for line in address %}
              <div data-test-id="org-page-address-{{ loop.index }}">{{ line }}</div>
            {% endfor %}
          </div>
        </div>
      </div>
    </div>

    {% if agreementSigned %}
      {{ checkedStatement({
        text: agreementSignedText,
        dataTestId: "agreement-signed-checked-statement"
      }) }}
    {% endif %}

    <hr/>
  
    <h3 data-test-id="accounts-subheading" class="nhsuk-u-font-weight-bold nhsuk-u-margin-bottom-7">{{ accountsSubheading }} {{ organisationName }}</h3>

    <div data-test-id="add-user-button">
      {{ button({
        text: addUserButtonText,
        classes: "nhsuk-u-margin-bottom-9",
        href: addUserButtonHref
      }) }}
    </div>


    <div data-test-id="user-table" class="nhsuk-u-font-size-19">
      {{ bcTable({
        columnInfo: columnInfo,
        data: users,
        columnClass: columnClass
      })}}
    </div>

    <h3 class="nhsuk-u-font-weight-bold nhsuk-u-margin-bottom-7">Related organisations</h3>
    <p>These are the organisations {{ organisationName }} can create orders for.</p>
    <div data-test-id="add-organisation-button">
      {{ button({
        text: "Add an organisation",
        classes: "nhsuk-u-margin-bottom-9",
        href: "/admin/organisations/proxy/" + organisationId
      }) }}
    </div>

    <div id="related-org-table" data-test-id="related-org-table" class="nhsuk-u-font-size-19">
      {{ bcTable({
        columnInfo: [
          {
            "data": "Organisation name"
          },
          {
            "data": "ODS code"
          },
          {}
        ],
        data: relatedOrgs,
        columnClass: columnClass
      })}}
    </div>
  </div>
{% endblock %}
